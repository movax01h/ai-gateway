Execute a complete remediation for the ONE specific vulnerability identified below. Analyze, plan, and implement a comprehensive fix that completely eliminates this security issue.

<location_verification_requirement>
BEFORE implementing any fix:
1. Confirm the vulnerability location from the report
2. Read the file and verify the vulnerable code exists at that exact line
3. If code_flows are provided, identify the SINK location as your PRIMARY fix target
4. Include location_validation in your response showing you verified the correct location

A fix applied to the wrong location is worse than no fix - it creates false confidence.
</location_verification_requirement>

<source_sink_analysis_reminder>
CRITICAL: Before proposing any fix, you MUST complete the source/sink analysis as specified in your system instructions.

Verify you have identified:
- SOURCE: Exact line where untrusted data enters (with code snippet)
- FLOW: Each function call in the data path (with line numbers)
- SINK: Exact line where dangerous operation occurs (with code snippet)
- ROOT CAUSE: Function-level explanation with code evidence
- ATTACK VECTOR: Concrete exploitation example with payload
- QUANTIFIABLE IMPROVEMENT: Before/after comparison proving the fix works

DO NOT proceed until you have evidence-based analysis for all six requirements.
</source_sink_analysis_reminder>

<execution_instructions>
CRITICAL REQUIREMENTS:
1. PERFORM source/sink analysis at function level before proposing fixes
2. VERIFY the vulnerability location before implementing
3. Fix ONLY the specific vulnerability instance reported
4. SCOPE all changes to:
   - Direct fixes for the reported vulnerability
   - Hardening related to the SAME weakness type
   - DO NOT include fixes for DIFFERENT vulnerability types
5. CREATE a complete fix that may span multiple CODE files if necessary
6. DOCUMENT every single change in your analysis
7. Follow the security guidance in the vulnerability description exactly
8. Ensure the fix is production-ready and maintains functionality
9. DO NOT create documentation files or add "FIXED:" comments

CODE QUALITY STANDARDS:
- Write clean, self-explanatory code
- Use meaningful variable/function names
- The git commit and MR description already document the fix

SCOPE ENFORCEMENT:
- Only fix the reported vulnerability type and harden related code paths
- Do NOT add fixes for unrelated vulnerability types
- When in doubt: "Is this change REQUIRED to fix THIS vulnerability type?"
</execution_instructions>

<execution_requirements>
Your fix MUST:
- Completely eliminate the reported vulnerability using security best practices
- Be based on evidence-based source/sink analysis, not assumptions
- Maintain all existing functionality without regression
- Be production-ready with proper error handling
- Include all necessary imports and dependencies
- Be clear and maintainable for future developers
- Stay within scope: vulnerability fix + related hardening for same weakness type ONLY
- Create only source code files essential for the fix (no temporary files, no build artifacts)

These requirements ensure:
- The vulnerability cannot be exploited after the fix
- The application continues to function correctly
- The fix doesn't introduce new vulnerabilities
- The MR is focused and reviewable
</execution_requirements>

<scope_decision_tree>
For each proposed change, follow this decision tree:

1. Is this change at the reported vulnerability location?
   YES -> PRIMARY change, proceed
   NO -> Continue to question 2

2. Does this change involve the SAME weakness type as the reported vulnerability?
   - Reported: SQL Injection -> Change: SQL parameterization elsewhere = SAME TYPE
   - Reported: SQL Injection -> Change: XSS encoding = DIFFERENT TYPE
   - Reported: Path Traversal -> Change: Path sanitization elsewhere = SAME TYPE
   - Reported: Path Traversal -> Change: Auth improvements = DIFFERENT TYPE

   DIFFERENT TYPE -> OUT OF SCOPE, do NOT include
   SAME TYPE -> Continue to question 3

3. Can you provide evidence this change addresses the same vulnerability type?
   - Processes the SAME untrusted data source
   - Could be exploited via the SAME attack vector
   - Prevents the SAME class of vulnerability

   NO evidence -> OUT OF SCOPE
   YES with evidence -> SUPPORTING change, document with scope justification
</scope_decision_tree>

<change_documentation_requirement>
Every change MUST be documented in your final JSON response:

For PRIMARY changes:
- Exact file and line numbers
- old_str and new_str
- Why this fixes the vulnerability

For SUPPORTING changes:
- Exact file and line numbers
- old_str and new_str
- Scope justification: How this relates to the SAME vulnerability type

**Good scope justification**: "This function also constructs SQL queries from user input (same weakness type). Parameterization here prevents similar vulnerabilities."

**Bad scope justification**: "Improves security" or "Related change"

FORBIDDEN changes (do not make these):
- Fixes for unrelated vulnerability types
- Unrelated refactoring or feature additions
- Performance optimizations or style improvements
</change_documentation_requirement>

<quality_expectation>
This is a critical security fix. Your changes should be:
- Based on evidence, not assumptions
- Focused on THIS vulnerability type only
- Immediately applicable via edit_file operations
- Clear enough for code review
- Fully documented with justification for each change

A partial fix leaves the application vulnerable. Out-of-scope changes create noise and make review harder.
</quality_expectation>

<final_checklist>
Before submitting, verify:

1. LOCATION: Confirmed vulnerable code at reported line; location_validation included
2. ANALYSIS: Source, sink, data flow, root cause, attack vector all have line numbers and code evidence
3. SCOPE: All changes fix THIS vulnerability type only; no unrelated improvements
4. DOCUMENTATION: Every change in implementation section with file, lines, old_str, new_str
5. QUALITY: No doc files created; no "FIXED:" comments; code is self-explanatory

If any item is missing, your fix may be incomplete or out of scope.
</final_checklist>
