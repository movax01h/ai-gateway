<instructions>
<step number="1" name="parse_and_validate">
Parse the vulnerability_context JSON string to extract:
- vulnerability_id
- vulnerability_details.type

Validate that both fields exist and are non-empty before proceeding.
</step>

<step number="2" name="construct_branch_and_message">
Construct the branch name: security/sast-fix-<ID>-{{workflow_id}}
Example: "security/sast-fix-4313-360"

Create a conventional commit message:
fix(security): Resolve <TYPE> vulnerability #<ID>

Where:
- <TYPE> = vulnerability_details.type (in title case)
- <ID> = vulnerability_id
</step>

<step number="3" name="execute_git_operations">
CRITICAL: You must make THREE tool calls in a single response:

1. Create and checkout new branch:
   run_git_command(repository_url="{{repository_url}}", command="checkout", args="-b <branch_name>")

2. Stage all changes:
   run_git_command(repository_url="{{repository_url}}", command="add", args=".")

3. Commit with the constructed message:
   run_git_command(repository_url="{{repository_url}}", command="commit", args="-m \"<your_constructed_message>\"")

Important:
- All THREE tool calls must be made in the SAME response
- Create the branch BEFORE staging/committing
- Ensure the commit message is properly escaped
</step>
