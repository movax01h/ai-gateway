CRITICAL OUTPUT FORMAT REQUIREMENT:
You MUST output ONLY valid JSON with no explanatory text, preamble, or markdown formatting.
Output the JSON object directly without any text before or after it.
Do not wrap the JSON in code blocks or markdown.
Do not include any explanatory text like "Based on my analysis..." or "Here is the result...".

When analyzing secret detection findings for false positive detection, follow these comprehensive guidelines:

<guidelines>
1. **Context Analysis**: Always examine the broader code context around the reported secret, including comments, variable names, and surrounding code.

2. **Secret Type Evaluation**:
  - API keys, tokens, passwords, private keys, etc.
  - Check if the detected value matches known patterns for real secrets
  - Evaluate entropy and randomness of the detected string
  - Consider the length and format of potential secrets

3. **Code Context Indicators**:
  - Variable names (e.g., "test_key", "dummy_password", "example_token")
  - Comments indicating test/demo data
  - File names suggesting test or example code
  - Presence of "TODO", "FIXME", or similar markers
  - Code in test directories or files

4. **False Positive Indicators**:
  - Obviously fake or placeholder values ("password123", "your-api-key-here")
  - Well-known test tokens or example values
  - Public keys (not private keys)
  - Base64 encoded but decodes to non-sensitive data
  - Secrets in documentation or README files
  - Secrets in comments or docstrings
  - Hardcoded values in test files
  - Configuration templates with placeholder values
  - Environment variable names without actual values
  - Secrets that are actually public constants or identifiers

5. **True Positive Indicators**:
  - High-entropy strings that look like real secrets
  - Actual API keys, tokens, or passwords in production code
  - Private keys or certificates
  - Secrets committed to version control in active code paths
  - No comments indicating it's test data
  - Variable names suggesting real credentials

6. **Common Secret Detection False Positives**:
  - Test data and fixtures
  - Example code in documentation
  - Placeholder values in configuration templates
  - Public API endpoints or identifiers
  - Base64 encoded images or binary data
  - UUIDs or other non-secret identifiers
  - Hash values or checksums
  - Public keys in cryptographic code
  - Well-known test tokens (e.g., GitHub's example tokens)

7. **Analysis Steps**:
  - Read the file containing the detected secret
  - Examine surrounding code and comments
  - Check variable names and context
  - Evaluate if the value looks like a real secret
  - Consider the file type and location
  - Check for indicators of test/demo code

8. **File Examination Strategy**:
  - Read the specific file mentioned in the finding
  - Look for comments explaining the context
  - Check variable names and assignments
  - Examine nearby code for clues about usage
  - Consider the file path (test/, examples/, docs/)
  - Look for other similar patterns in the codebase

9. **Output Requirements**:
  - Create a JSON payload
  - Include false_positive_likelihood (0-100 scale)
  - Provide detailed explanation of your analysis
  - Reference specific code sections and context
  - Explain why the finding is or isn't a real secret

10. **False Positive Likelihood Scale**:
  - 0-20: Definitely a true positive (high risk) - appears to be a real secret
  - 21-40: Likely a true positive (moderate-high risk) - suspicious but unclear
  - 41-60: Uncertain (requires manual review) - ambiguous context
  - 61-80: Likely a false positive (low-moderate risk) - probably test data
  - 81-100: Definitely a false positive (very low risk) - clearly not a real secret

11. **Recommendations for True Positives** (false_positive_likelihood < 61):
  When a finding is determined to be a true positive or likely true positive, provide:

  a) **Severity Assessment**:
    - Evaluate the impact of the leaked secret
    - Consider the type of secret (API key, password, private key, etc.)
    - Assess potential damage if exploited

  b) **Remediation Guidance**:
    - Immediate actions: revoke/regenerate the secret
    - Code changes: move to environment variables or secret management
    - Prevention: implement secret scanning in CI/CD
    - Best practices for secret management
</guidelines>

Analyze the following secret detection finding for false positive detection:

{{vulnerability_details}}

Please perform a comprehensive analysis by:
  1. Reading the source code file mentioned in the finding
  2. Examining the broader context around the reported secret
  3. Evaluating the detected value and its context
  4. Determining if this is a true positive or false positive
  5. If true positive: Providing detailed remediation guidance

Use the available tools to:
  - Read the relevant source code files
  - Find and examine related files in the repository
  - Create a JSON analysis result payload

CRITICAL: You MUST provide a JSON payload with your final analysis results.

The JSON should contain:
{%- raw %}
{
  "false_positive_likelihood": <number between 0 and 100>,
  "explanation": "<detailed explanation - see structure below>"
}
{% endraw %}

Where:
  - false_positive_likelihood: 0 = definitely true positive, 100 = definitely false positive
  - explanation: A comprehensive analysis structured as follows:

**For FALSE POSITIVES (false_positive_likelihood >= 61):**
The explanation should include:
  - Summary of the finding and why it's a false positive
  - Code references and context that prove it's not a real secret
  - Indicators that it's test data, placeholder, or non-sensitive
  - Why the secret detection tool flagged this incorrectly

**For TRUE POSITIVES (false_positive_likelihood < 61):**
The explanation should include ALL of the following sections:

1. **Secret Analysis**
  - Summary of the detected secret and why it's a true positive
  - Code references showing the secret in context
  - Analysis of the secret value (entropy, format, etc.)
  - Why it appears to be a real secret

2. **Impact Assessment**
  - Type of secret (API key, password, private key, etc.)
  - Potential impact if exploited
  - Scope of access granted by the secret

3. **Remediation Guidance**
  - Immediate actions: revoke or regenerate the secret
  - Code changes needed to secure the secret
  - Best practices for secret management
  - Prevention measures for future incidents

4. **Contextual Factors**
  - How the secret was committed
  - Whether it's still active
  - Any mitigating factors

Provide detailed reasoning for your conclusion and create the analysis result JSON.
