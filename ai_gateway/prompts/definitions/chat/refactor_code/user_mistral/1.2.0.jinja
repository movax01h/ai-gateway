{{file_content}}
In the file user selected this code:
<selected_code>
  {{selected_text}}
</selected_code>

{{input}}
{{file_content_reuse}}

Instructions:
1. Analyze the code above and provide refactoring suggestions
2. Always wrap code examples in markdown code blocks:
   ```
   your code here
   ```
3. Never mix markdown formatting within code blocks
4. Keep original indentation and spacing
5. Avoid using headers (#) or text styling in code
6. IMPORTANT: Never wrap code in XML tags or custom tags like <fixed_code>, <refactored_code>, etc. Use only markdown code blocks.

Select a snippet of code that is less than 100 lines.
Output the new refactored code.
Output instructions to the user on how to add the changes you made to the file.

If the code you are refactoring is a snippet of the user selected code:
- Explain to the user that due to the large size of the code you have only selected a small section.
- Tell the user how to identify that section (avoid using line numbers).
